<!DOCTYPE html>
<html>
    <head>
        <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet" />
        <link href="https://cdn.jsdelivr.net/npm/@mdi/font@6.x/css/materialdesignicons.min.css" rel="stylesheet" />
        <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui"
        />
    </head>
    <body>
        <div id="app">
            <v-app>
                <v-main>
                    <v-container>
                        <v-row>
                            <v-col><v-select :items="[1,2,3,5,10]" v-model="count"></v-select></v-col>
                            <v-col>
                                <v-select
                                    :items="[{text: 'Async', value: true}, {text: 'Sync', value: false}]"
                                    v-model="async"
                                ></v-select>
                            </v-col>
                        </v-row>
                        <pre>{{ async }}</pre>
                        <v-btn @click="startTest">Test</v-btn>
                    </v-container>
                </v-main>
            </v-app>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
        <script>
            let ws;
            new Vue({
                el: '#app',
                vuetify: new Vuetify(),
                data() {
                    return {
                        count: 3,
                        async: true,
                    };
                },
                mounted() {
                    ws = new WebSocket('ws://' + document.location.hostname + ':81');
                    ws.onopen = this.onOpen;
                    ws.onmessage = this.onMessage;
                },
                methods: {
                    send(msg) {
                        ws.send(JSON.stringify(msg));
                    },
                    startTest() {
                        this.send({ async: this.async, count: this.count });
                    },
                    onOpen() {
                        console.log('on open');
                        this.startTest();
                    },
                    onMessage(msg) {
                        console.log(msg.data);
                    },
                },
            });
        </script>
    </body>
</html>
